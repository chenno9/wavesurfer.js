!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("editor",[],e):"object"==typeof exports?exports.editor=e():(t.WaveSurfer=t.WaveSurfer||{},t.WaveSurfer.editor=e())}("undefined"!=typeof self?self:this,function(){return function(t){function e(r){if(a[r])return a[r].exports;var i=a[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var a={};return e.m=t,e.c=a,e.d=function(t,a,r){e.o(t,a)||Object.defineProperty(t,a,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var a=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(a,"a",a),a},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="localhost:8080/dist/plugin/",e(e.s=7)}({7:function(t,e,a){"use strict";WaveSurfer.Editor={init:function(t){this.wavesurfer=t,this.clipboard={empty:!0,data:null},this.undoActions=[],this.redoActions=[]},getOriginalData:function(){for(var t=this.wavesurfer.backend.buffer,e=[],a=0;a<t.numberOfChannels;a++)e.push(t.getChannelData(a));return e},getTarget:function(){var t,e,a,r=this.wavesurfer.regions.list,i=!1;for(var s in r){if(i)break;if(r.hasOwnProperty(s)){var n=r[s];e=n.start,a=n.end,i=!0}}if(i){var o=this.wavesurfer.backend.buffer.sampleRate;t={start:~~(e*o),end:~~(a*o)}}return t},updateView:function(t){var e=this.wavesurfer.backend.buffer.sampleRate,a=this.wavesurfer.backend.ac;this.wavesurfer.backend.buffer=null;var r;console.log("newData"),console.log(t),1==t.length?(r=a.createBuffer(1,t[0].length,e),r.copyToChannel(t[0],0,0)):2==t.length&&(r=a.createBuffer(2,t[0].length,e),r.copyToChannel(t[0],0,0),r.copyToChannel(t[1],1,0)),console.log("newBuffer"),console.log(r),this.wavesurfer.loadDecodedBuffer(r),this.wavesurfer.pause(),this.wavesurfer.clearRegions()},calcProgress:function(t){return 1*t/(1*this.wavesurfer.backend.buffer.length)},cut:function(){var t=this.getTarget();if(t){var e=this.getOriginalData(),a=Object.create(WaveSurfer.CutOperation);a.init(e,t.start,t.end),a.cut(),this.undoActions.push(a),this.clipboard.empty=!1,this.clipboard.data=a.cutData,this.updateView(a.newData),this.wavesurfer.seekAndCenter(this.calcProgress(t.start))}},copy:function(){var t=this.getTarget();if(t){var e=this.getOriginalData(),a=Object.create(WaveSurfer.CopyOperation);a.init(e,t.start,t.end),a.copy(),this.clipboard.empty=!1,this.clipboard.data=a.copyData,this.wavesurfer.pause(),this.wavesurfer.clearRegions()}},paste:function(){if(!this.clipboard.empty&&this.clipboard.data){var t=this.getOriginalData(),e=this.wavesurfer.backend.buffer.sampleRate,a=~~(this.wavesurfer.backend.startPosition*e),r=Object.create(WaveSurfer.PasteOperation);r.init(t,this.clipboard.data,a),r.paste(),this.undoActions.push(r),this.updateView(r.newData),this.wavesurfer.seekAndCenter(this.calcProgress(a))}},del:function(){var t=this.getTarget();if(t){var e=this.getOriginalData(),a=Object.create(WaveSurfer.DelOperation);a.init(e,t.start,t.end),a.del(),this.undoActions.push(a),this.updateView(a.newData),this.wavesurfer.seekAndCenter(this.calcProgress(t.start))}},undo:function(){var t=this.undoActions.pop();t&&(this.redoActions.push(t),this.updateView(t.oldData),this.wavesurfer.seekAndCenter(this.calcProgress(t.start)))},redo:function(){var t=this.redoActions.pop();t&&(this.undoActions.push(t),this.updateView(t.newData),this.wavesurfer.seekAndCenter(this.calcProgress(t.start)))}},WaveSurfer.CutOperation={init:function(t,e,a){this.oldData=t,this.start=e,this.end=a},cut:function(){for(var t=[],e=[],a=0;a<this.oldData.length;a++){for(var r=new Float32Array(this.oldData[a].length-(this.end-this.start)),i=0,s=0;s<this.start;s++)r[i++]=this.oldData[a][s];for(var s=this.end;s<this.oldData[a].length;s++)r[i++]=this.oldData[a][s];t.push(r),e.push(this.oldData[a].subarray(this.start,this.end))}this.newData=t,this.cutData=e,console.log(t)}},WaveSurfer.CopyOperation={init:function(t,e,a){this.data=t,this.start=e,this.end=a},copy:function(){for(var t=[],e=0;e<this.data.length;e++)t.push(this.data[e].subarray(this.start,this.end));this.copyData=t}},WaveSurfer.PasteOperation={init:function(t,e,a){this.oldData=t,this.pasteData=e,this.start=a},paste:function(){for(var t=[],e=0;e<this.oldData.length;e++){for(var a=new Float32Array(this.oldData[e].length+this.pasteData[e].length),r=0,i=0;i<this.start;i++)a[r++]=this.oldData[e][i];for(var i=0;i<this.pasteData[e].length;i++)a[r++]=this.pasteData[e][i];for(var i=this.start;i<this.oldData[e].length;i++)a[r++]=this.oldData[e][i];t.push(a)}this.newData=t}},WaveSurfer.DelOperation={init:function(t,e,a){this.oldData=t,this.start=e,this.end=a},del:function(){for(var t=[],e=0;e<this.oldData.length;e++){for(var a=new Float32Array(this.oldData[e].length-(this.end-this.start)),r=0,i=0;i<this.start;i++)a[r++]=this.oldData[e][i];for(var i=this.end;i<this.oldData[e].length;i++)a[r++]=this.oldData[e][i];t.push(a)}this.newData=t}},WaveSurfer.initEditor=function(){this.editor||(this.editor=Object.create(WaveSurfer.Editor),this.editor.init(this))},WaveSurfer.destroyEditor=function(){this.editor=null}}})});
//# sourceMappingURL=wavesurfer.editor.min.js.map